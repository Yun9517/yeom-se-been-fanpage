{"version":3,"file":"static/js/69.f57fa10f.chunk.js","mappings":"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","sources":["components/FanQuiz.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\r\nimport { Helmet } from 'react-helmet-async';\r\nimport { FiRefreshCcw, FiLink } from 'react-icons/fi';\r\nimport { FaLine } from 'react-icons/fa';\r\nimport { Spinner, Alert } from 'react-bootstrap';\r\nimport './FanQuiz.css';\r\n\r\nimport { db } from '../firebase';\r\nimport { collection, getDocs } from 'firebase/firestore';\r\n\r\n\r\n// Helper function to get random questions\r\nconst getRandomQuestions = (allQuestions, num = 5) => {\r\n  const shuffled = [...allQuestions].sort(() => 0.5 - Math.random());\r\n  return shuffled.slice(0, num);\r\n};\r\n\r\nfunction FanQuiz() {\r\n  const [masterQuestions, setMasterQuestions] = useState([]);\r\n  const [questions, setQuestions] = useState([]);\r\n  const [currentQuestion, setCurrentQuestion] = useState(0);\r\n  const [score, setScore] = useState(0);\r\n  const [showScore, setShowScore] = useState(false);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [userAnswers, setUserAnswers] = useState([]); // New state for user answers\r\n\r\n  useEffect(() => {\r\n    const fetchQuestions = async () => {\r\n      try {\r\n        const querySnapshot = await getDocs(collection(db, \"quizzes\"));\r\n        const fetchedQuestions = querySnapshot.docs.map(doc => doc.data());\r\n        setMasterQuestions(fetchedQuestions);\r\n        setQuestions(getRandomQuestions(fetchedQuestions));\r\n        setLoading(false);\r\n      } catch (err) {\r\n        console.error(\"Error fetching questions from Firestore:\", err);\r\n        setError(\"無法載入題目，請稍後再試。\");\r\n        setLoading(false);\r\n      }\r\n    };\r\n    fetchQuestions();\r\n  }, []);\r\n\r\n  const handleAnswerOptionClick = (selectedOption) => {\r\n    const currentQ = questions[currentQuestion];\r\n    const isCorrect = selectedOption === currentQ.answer;\r\n\r\n    if (isCorrect) {\r\n      setScore(score + 1);\r\n    }\r\n\r\n    // Record the user's answer\r\n    setUserAnswers(prevAnswers => [\r\n      ...prevAnswers,\r\n      {\r\n        question: currentQ.question,\r\n        correctAnswer: currentQ.answer,\r\n        userAnswer: selectedOption,\r\n        isCorrect: isCorrect,\r\n      },\r\n    ]);\r\n\r\n    const nextQuestion = currentQuestion + 1;\r\n    if (nextQuestion < questions.length) {\r\n      setCurrentQuestion(nextQuestion);\r\n    } else {\r\n      setShowScore(true);\r\n    }\r\n  };\r\n\r\n  const resetQuiz = useCallback(() => {\r\n    setCurrentQuestion(0);\r\n    setScore(0);\r\n    setShowScore(false);\r\n    setQuestions(getRandomQuestions(masterQuestions));\r\n    setUserAnswers([]); // Clear user answers on reset\r\n  }, [masterQuestions]);\r\n\r\n  const generateShareContent = () => {\r\n    const shareText = `我在 염세빈 粉絲小遊戲中獲得了 ${score} 分！快來挑戰看看你的分數！`;\r\n    const shareUrl = window.location.href;\r\n    return { shareText, shareUrl };\r\n  };\r\n\r\n  const handleShareLink = () => {\r\n    const { shareText, shareUrl } = generateShareContent();\r\n    const fullShareLink = `${shareText} ${shareUrl}`;\r\n    navigator.clipboard.writeText(fullShareLink).then(() => {\r\n      alert('分享連結已複製到剪貼簿！');\r\n    }).catch(err => {\r\n      console.error('無法複製分享連結:', err);\r\n    });\r\n  };\r\n\r\n  const handleShareLine = () => {\r\n    const { shareText, shareUrl } = generateShareContent();\r\n    const lineMessage = `${shareText} ${shareUrl}`;\r\n    const lineShareUrl = `https://line.me/R/msg/text/?${encodeURIComponent(lineMessage)}`;\r\n    window.open(lineShareUrl, '_blank');\r\n  };\r\n\r\n  // Use ImageWithFallback for the Open Graph image\r\n  const ogImageUrl = `yeomsebeen_field.jpg`; // Just the filename\r\n\r\n  return (\r\n    <div className=\"fan-quiz-container\">\r\n      <Helmet>\r\n        <title>염세빈 粉絲小遊戲！</title>\r\n        <meta property=\"og:title\" content=\"염세빈 粉絲小遊戲！\" />\r\n        <meta property=\"og:description\" content=\"快來挑戰看看你對廉世彬的了解程度！\" />\r\n        {/* For Open Graph image, we need the direct URL, so we construct it here */}\r\n        <meta property=\"og:image\" content={`https://storage.googleapis.com/yeom-se-been-fanpage-assets/${ogImageUrl}`} />\r\n        <meta property=\"og:url\" content={window.location.href} />\r\n        <meta name=\"twitter:card\" content=\"summary_large_image\" />\r\n        <meta name=\"twitter:image\" content={`https://storage.googleapis.com/yeom-se-been-fanpage-assets/${ogImageUrl}`} />\r\n      </Helmet>\r\n      <h2>염세빈 粉絲小遊戲！</h2>\r\n\r\n      {loading && (\r\n        <div className=\"text-center\">\r\n          <Spinner animation=\"border\" variant=\"light\" />\r\n          <p className=\"text-white-50 mt-2\">載入中...</p>\r\n        </div>\r\n      )}\r\n      {error && <Alert variant=\"danger\">{error}</Alert>}\r\n\r\n      {!loading && !error && (\r\n        showScore ? (\r\n          <div className=\"score-section\">\r\n            <div className=\"score-text\">你獲得了 {score} 分，總分 {questions.length} 分！</div>\r\n            <div className=\"score-buttons\">\r\n              <button onClick={handleShareLink} className=\"quiz-button share-link-button\"><FiLink /></button>\r\n              <button onClick={resetQuiz} className=\"quiz-button play-again-button\"><FiRefreshCcw /></button>\r\n              <button onClick={handleShareLine} className=\"quiz-button share-line-button\"><FaLine /></button>\r\n            </div>\r\n\r\n            {/* New section to display answers */}\r\n            <div className=\"quiz-answers-summary mt-4\">\r\n              <h3>作答結果</h3>\r\n              {userAnswers.map((item, index) => (\r\n                <div key={index} className=\"answer-item mb-3 p-3 border rounded\">\r\n                  <p><strong>問題 {index + 1}:</strong> {item.question}</p>\r\n                  <p><strong>你的答案:</strong> <span style={{ color: item.isCorrect ? '#28a745' : '#dc3545' }}>{item.userAnswer}</span></p>\r\n                  {!item.isCorrect && (\r\n                    <p><strong>正確答案:</strong> <span style={{ color: '#28a745' }}>{item.correctAnswer}</span></p>\r\n                  )}\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          questions.length > 0 && (\r\n            <div className=\"question-section\">\r\n              <div className=\"question-count\">\r\n                <span>問題 {currentQuestion + 1}</span>/{questions.length}\r\n              </div>\r\n              <div className=\"question-text\">\r\n                {questions[currentQuestion]?.question}\r\n              </div>\r\n              <div className=\"answer-section\">\r\n                {questions[currentQuestion]?.options.map((option, index) => (\r\n                  <button key={index} onClick={() => handleAnswerOptionClick(option)}>\r\n                    {option}\r\n                  </button>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          )\r\n        )\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default FanQuiz;"],"names":["getRandomQuestions","allQuestions","num","arguments","length","undefined","sort","Math","random","slice","_questions$currentQue","_questions$currentQue2","masterQuestions","setMasterQuestions","useState","questions","setQuestions","currentQuestion","setCurrentQuestion","score","setScore","showScore","setShowScore","loading","setLoading","error","setError","userAnswers","setUserAnswers","useEffect","async","fetchedQuestions","getDocs","collection","db","docs","map","doc","data","err","console","fetchQuestions","resetQuiz","useCallback","generateShareContent","shareText","shareUrl","window","location","href","ogImageUrl","_jsxs","className","children","Helmet","_jsx","property","content","name","Spinner","animation","variant","Alert","onClick","handleShareLink","fullShareLink","navigator","clipboard","writeText","then","alert","catch","FiLink","FiRefreshCcw","handleShareLine","lineShareUrl","encodeURIComponent","open","FaLine","item","index","question","style","color","isCorrect","userAnswer","correctAnswer","options","option","selectedOption","currentQ","answer","prevAnswers","nextQuestion","handleAnswerOptionClick"],"sourceRoot":""}