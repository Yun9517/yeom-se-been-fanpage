"use strict";(self.webpackChunkyeom_se_been_fanpage=self.webpackChunkyeom_se_been_fanpage||[]).push([[430],{5430:(e,s,r)=>{r.r(s),r.d(s,{default:()=>w});var n=r(5043),t=r(791),c=r(6667),l=r(8279),a=r(3519),i=r(7417),d=r(1719),o=r(9437),h=r(8139),x=r.n(h),u=r(7852),j=r(1068),m=r(9334),p=r(579);const A=n.forwardRef((e,s)=>{let{className:r,bsPrefix:n,as:t="span",...c}=e;return n=(0,u.oU)(n,"input-group-text"),(0,p.jsx)(t,{ref:s,className:x()(r,n),...c})});A.displayName="InputGroupText";const f=A,g=n.forwardRef((e,s)=>{let{bsPrefix:r,size:t,hasValidation:c,className:l,as:a="div",...i}=e;r=(0,u.oU)(r,"input-group");const d=(0,n.useMemo)(()=>({}),[]);return(0,p.jsx)(m.A.Provider,{value:d,children:(0,p.jsx)(a,{ref:s,...i,className:x()(l,r,t&&`${r}-${t}`,c&&"has-validation")})})});g.displayName="InputGroup";const v=Object.assign(g,{Text:f,Radio:e=>(0,p.jsx)(f,{children:(0,p.jsx)(j.A,{type:"radio",...e})}),Checkbox:e=>(0,p.jsx)(f,{children:(0,p.jsx)(j.A,{type:"checkbox",...e})})});var y=r(6522),b=r(4282),N=r(4196),C=r(457),k=r(184);const w=()=>{const[e,s]=(0,l.hD)(t.j),[r,h]=(0,n.useState)([]),[x,u]=(0,n.useState)({}),[j,m]=(0,n.useState)(!0),[A,f]=(0,n.useState)(null),[g,w]=(0,n.useState)("createdAt"),[S,I]=(0,n.useState)("desc"),[_,M]=(0,n.useState)(1),[P,E]=(0,n.useState)(10),[G,z]=(0,n.useState)(null),[D,H]=(0,n.useState)([null]),[q,B]=(0,n.useState)(!1),[R,T]=(0,n.useState)("");(0,n.useEffect)(()=>{e?(M(1),z(null),H([null]),B(!1),f(null)):(h([]),m(!1),f("\u8acb\u5148\u767b\u5165\u4ee5\u67e5\u770b\u904a\u6232\u7d00\u9304\u3002"),M(1),z(null),H([null]),B(!1))},[e]),(0,n.useEffect)(()=>{(async()=>{if(!s&&e){m(!0);try{const s=(0,c.H9)(t.db,"userAchievements",e.uid),r=await(0,c.x7)(s);let n;r.exists()?u(r.data()):u({}),n=null===D[_-1]?(0,c.P)((0,c.rJ)(t.db,"scores"),(0,c._M)("userId","==",e.uid),(0,c.My)(g,S),(0,c.AB)(P+1)):(0,c.P)((0,c.rJ)(t.db,"scores"),(0,c._M)("userId","==",e.uid),(0,c.My)(g,S),(0,c.HM)(D[_-1]),(0,c.AB)(P+1));const l=await(0,c.GG)(n),a=[];l.forEach(e=>{a.push({id:e.id,...e.data()})}),B(a.length>P);const i=a.slice(0,P);h(i),z(l.docs[i.length-1])}catch(r){console.error("Error fetching quiz history:",r),f("\u7121\u6cd5\u8f09\u5165\u904a\u6232\u7d00\u9304\uff0c\u8acb\u7a0d\u5f8c\u518d\u8a66\u3002")}finally{m(!1)}}})()},[e,s,g,S,_,P,D]);const F=e=>{e===g?I("asc"===S?"desc":"asc"):(w(e),I("desc")),M(1),z(null),H([null]),B(!1)},J=e=>{E(e),M(1),z(null),H([null]),B(!1)},K=()=>{const e=parseInt(R,10);e>0?J(e):alert("\u8acb\u8f38\u5165\u6709\u6548\u7684\u6578\u5b57\u3002")};if(s)return(0,p.jsxs)(a.A,{className:"mt-5 text-center",children:[(0,p.jsx)(i.A,{animation:"border",variant:"light"}),(0,p.jsx)("p",{className:"text-white-50 mt-2",children:"\u8f09\u5165\u4f7f\u7528\u8005\u72c0\u614b..."})]});if(j)return(0,p.jsxs)(a.A,{className:"mt-5 text-center",children:[(0,p.jsx)(i.A,{animation:"border",variant:"light"}),(0,p.jsx)("p",{className:"text-white-50 mt-2",children:"\u8f09\u5165\u904a\u6232\u7d00\u9304\u4e2d..."})]});if(A)return(0,p.jsx)(a.A,{className:"mt-5",children:(0,p.jsx)(d.A,{variant:"danger",children:A})});if(!e)return(0,p.jsx)(a.A,{className:"mt-5",children:(0,p.jsx)(d.A,{variant:"info",children:"\u8acb\u767b\u5165\u4ee5\u67e5\u770b\u60a8\u7684\u904a\u6232\u7d00\u9304\u3002"})});if(e.isAnonymous)return(0,p.jsx)(a.A,{className:"mt-5",children:(0,p.jsx)(d.A,{variant:"info",children:"\u60a8\u76ee\u524d\u4ee5\u8a2a\u5ba2\u6a21\u5f0f\u767b\u5165\u3002\u5982\u9700\u67e5\u770b\u4e26\u5132\u5b58\u904a\u6232\u7d00\u9304\uff0c\u8acb\u4f7f\u7528 Google \u5e33\u6236\u767b\u5165\u3002"})});const U=x.totalQuizSessions||0,$=r.reduce((e,s)=>Math.max(e,s.score),0),L=r.length>0?(r.reduce((e,s)=>e+s.score,0)/r.length).toFixed(2):0;return(0,p.jsxs)(a.A,{className:"mt-5 leaderboard-container",children:[(0,p.jsx)("h2",{children:"\u6211\u7684\u904a\u6232\u7d00\u9304"}),(0,p.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[(0,p.jsxs)("div",{className:"mb-4 p-3 rounded",style:{backgroundColor:"#343a40",color:"#e9ecef"},children:[(0,p.jsxs)("p",{children:[(0,p.jsx)("strong",{children:"\u7e3d\u904a\u6232\u6b21\u6578:"})," ",U]}),(0,p.jsxs)("p",{children:[(0,p.jsx)("strong",{children:"\u672c\u9801\u904a\u6232\u6b21\u6578:"})," ",r.length]}),(0,p.jsxs)("p",{children:[(0,p.jsx)("strong",{children:"\u6700\u9ad8\u5206\u6578 (\u672c\u9801):"})," ",$]}),(0,p.jsxs)("p",{children:[(0,p.jsx)("strong",{children:"\u5e73\u5747\u5206\u6578 (\u672c\u9801):"})," ",L]})]}),(0,p.jsxs)(o.A,{className:"ms-auto",children:[(0,p.jsxs)(o.A.Toggle,{variant:"secondary",id:"dropdown-items-per-page",children:["\u6bcf\u9801\u986f\u793a: ",P]}),(0,p.jsxs)(o.A.Menu,{children:[(0,p.jsx)(o.A.Item,{onClick:()=>J(10),children:"10"}),(0,p.jsx)(o.A.Item,{onClick:()=>J(20),children:"20"}),(0,p.jsx)(o.A.Item,{onClick:()=>J(50),children:"50"}),(0,p.jsx)(o.A.Divider,{}),(0,p.jsx)(o.A.Item,{as:"div",onClick:e=>e.stopPropagation(),children:(0,p.jsxs)(v,{className:"p-2",children:[(0,p.jsx)(y.A.Control,{type:"number",placeholder:"\u81ea\u8a02",value:R,onChange:e=>T(e.target.value),onKeyPress:e=>{"Enter"===e.key&&K()}}),(0,p.jsx)(b.A,{variant:"outline-secondary",onClick:K,children:"\u8a2d\u5b9a"})]})})]})]})]}),0===r.length?(0,p.jsx)(d.A,{variant:"info",children:"\u60a8\u9084\u6c92\u6709\u4efb\u4f55\u904a\u6232\u7d00\u9304\u3002"}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(N.A,{striped:!0,bordered:!0,hover:!0,responsive:!0,variant:"dark",children:[(0,p.jsx)("thead",{children:(0,p.jsxs)("tr",{children:[(0,p.jsxs)("th",{onClick:()=>F("createdAt"),style:{cursor:"pointer"},children:["\u65e5\u671f ","createdAt"===g&&("asc"===S?"\u25b2":"\u25bc")]}),(0,p.jsxs)("th",{onClick:()=>F("score"),style:{cursor:"pointer"},children:["\u5206\u6578 ","score"===g&&("asc"===S?"\u25b2":"\u25bc")]}),(0,p.jsx)("th",{children:"\u4f5c\u7b54\u7d50\u679c"})]})}),(0,p.jsx)("tbody",{children:r.map(e=>{var s;return(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:null===(s=e.createdAt)||void 0===s?void 0:s.toDate().toLocaleDateString()}),(0,p.jsx)("td",{children:e.score}),(0,p.jsx)("td",{children:(0,p.jsx)(C.A,{className:"quiz-history-accordion",children:(0,p.jsxs)(C.A.Item,{eventKey:"0",children:[(0,p.jsx)(C.A.Header,{children:"\u67e5\u770b\u8a73\u60c5"}),(0,p.jsx)(C.A.Body,{children:e.userAnswers&&e.userAnswers.length>0?e.userAnswers.map((e,s)=>(0,p.jsxs)("div",{className:"mb-2 p-2 border rounded",children:[(0,p.jsxs)("p",{children:[(0,p.jsx)("strong",{children:"\u554f\u984c:"})," ",e.question]}),(0,p.jsxs)("p",{children:[(0,p.jsx)("strong",{children:"\u4f60\u7684\u7b54\u6848:"})," ",(0,p.jsxs)("span",{style:{color:e.isCorrect?"#28a745":"#dc3545"},children:[e.userAnswer," ",e.isCorrect?(0,p.jsx)(k.A7C,{color:"#28a745"}):(0,p.jsx)(k._Hm,{color:"#dc3545"})]})]}),!e.isCorrect&&(0,p.jsxs)("p",{children:[(0,p.jsx)("strong",{children:"\u6b63\u78ba\u7b54\u6848:"})," ",(0,p.jsx)("span",{style:{color:"#28a745"},children:e.correctAnswer})]})]},s)):(0,p.jsx)("p",{children:"\u7121\u8a73\u7d30\u4f5c\u7b54\u7d50\u679c\u3002"})})]})})})]},e.id)})})]}),(0,p.jsxs)("div",{className:"d-flex justify-content-between mt-3",children:[_>1&&(0,p.jsx)(b.A,{onClick:()=>{if(_>1){M(e=>e-1);const e=[...D];e.pop(),H(e),z(e[e.length-1])}},disabled:j,variant:"secondary",children:"\u4e0a\u4e00\u9801"}),q&&(0,p.jsx)(b.A,{onClick:()=>{q&&(M(e=>e+1),H(e=>[...e,G]))},disabled:j,variant:"secondary",className:"ms-auto",children:"\u4e0b\u4e00\u9801"})]})]})]})}}}]);
//# sourceMappingURL=430.c0691859.chunk.js.map