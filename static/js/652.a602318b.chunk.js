"use strict";(self.webpackChunkyeom_se_been_fanpage=self.webpackChunkyeom_se_been_fanpage||[]).push([[652],{1652:(e,t,n)=>{n.r(t),n.d(t,{default:()=>de});var s=n(5043),r=n(791),a=n(6667),i=n(8279),o=n(3519),l=n(8139),d=n.n(l),c=n(7852),m=n(579);const u=s.forwardRef((e,t)=>{let{bsPrefix:n,variant:s,animation:r="border",size:a,as:i="div",className:o,...l}=e;n=(0,c.oU)(n,"spinner");const u=`${n}-${r}`;return(0,m.jsx)(i,{ref:t,...l,className:d()(o,u,a&&`${u}-${a}`,s&&`text-${s}`)})});u.displayName="Spinner";const x=u;var f=n(1719),v=n(1969),b=n(6350),h=n(60),j=n(8466),y=n(5901),N=n(8187);const p=["active","eventKey","mountOnEnter","transition","unmountOnExit","role","onEnter","onEntering","onEntered","onExit","onExiting","onExited"],E=["activeKey","getControlledId","getControllerId"],A=["as"];function g(e,t){if(null==e)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}function C(e){let{active:t,eventKey:n,mountOnEnter:r,transition:a,unmountOnExit:i,role:o="tabpanel",onEnter:l,onEntering:d,onEntered:c,onExit:m,onExiting:u,onExited:x}=e,f=g(e,p);const v=(0,s.useContext)(j.A);if(!v)return[Object.assign({},f,{role:o}),{eventKey:n,isActive:t,mountOnEnter:r,transition:a,unmountOnExit:i,onEnter:l,onEntering:d,onEntered:c,onExit:m,onExiting:u,onExited:x}];const{activeKey:b,getControlledId:h,getControllerId:N}=v,A=g(v,E),C=(0,y.u)(n);return[Object.assign({},f,{role:o,id:h(n),"aria-labelledby":N(n)}),{eventKey:n,isActive:null==t&&null!=C?(0,y.u)(b)===C:t,transition:a||A.transition,mountOnEnter:null!=r?r:A.mountOnEnter,unmountOnExit:null!=i?i:A.unmountOnExit,onEnter:l,onEntering:d,onEntered:c,onExit:m,onExiting:u,onExited:x}]}const w=s.forwardRef((e,t)=>{let{as:n="div"}=e,s=g(e,A);const[r,{isActive:a,onEnter:i,onEntering:o,onEntered:l,onExit:d,onExiting:c,onExited:u,mountOnEnter:x,unmountOnExit:f,transition:v=N.A}]=C(s);return(0,m.jsx)(j.A.Provider,{value:null,children:(0,m.jsx)(y.A.Provider,{value:null,children:(0,m.jsx)(v,{in:a,onEnter:i,onEntering:o,onEntered:l,onExit:d,onExiting:c,onExited:u,mountOnEnter:x,unmountOnExit:f,children:(0,m.jsx)(n,Object.assign({},r,{ref:t,hidden:!a,"aria-hidden":!a}))})})})});w.displayName="TabPanel";const O=e=>{const{id:t,generateChildId:n,onSelect:r,activeKey:a,defaultActiveKey:i,transition:o,mountOnEnter:l,unmountOnExit:d,children:c}=e,[u,x]=(0,b.iC)(a,i,r),f=(0,h.Cc)(t),v=(0,s.useMemo)(()=>n||((e,t)=>f?`${f}-${t}-${e}`:null),[f,n]),N=(0,s.useMemo)(()=>({onSelect:x,activeKey:u,transition:o,mountOnEnter:l||!1,unmountOnExit:d||!1,getControlledId:e=>v(e,"tabpane"),getControllerId:e=>v(e,"tab")}),[x,u,o,l,d,v]);return(0,m.jsx)(j.A.Provider,{value:N,children:(0,m.jsx)(y.A.Provider,{value:x||null,children:c})})};O.Panel=w;const P=O;var $=n(7909),T=n(4541),k=n(4522);const I=s.forwardRef((e,t)=>{let{className:n,bsPrefix:s,as:r="div",...a}=e;return s=(0,c.oU)(s,"tab-content"),(0,m.jsx)(r,{ref:t,className:d()(n,s),...a})});I.displayName="TabContent";const K=I;var R=n(8072);function S(e){return"boolean"===typeof e?e?R.A:N.A:e}const U=s.forwardRef((e,t)=>{let{bsPrefix:n,transition:s,...r}=e;const[{className:a,as:i="div",...o},{isActive:l,onEnter:u,onEntering:x,onEntered:f,onExit:v,onExiting:b,onExited:h,mountOnEnter:N,unmountOnExit:p,transition:E=R.A}]=C({...r,transition:S(s)}),A=(0,c.oU)(n,"tab-pane");return(0,m.jsx)(j.A.Provider,{value:null,children:(0,m.jsx)(y.A.Provider,{value:null,children:(0,m.jsx)(E,{in:l,onEnter:u,onEntering:x,onEntered:f,onExit:v,onExiting:b,onExited:h,mountOnEnter:N,unmountOnExit:p,children:(0,m.jsx)(i,{...o,ref:t,className:d()(a,A,l&&"active")})})})})});U.displayName="TabPane";const B=U;var H=n(2663);function M(e){let t;return(0,H.jJ)(e,e=>{null==t&&(t=e.props.eventKey)}),t}function L(e){const{title:t,eventKey:n,disabled:s,tabClassName:r,tabAttrs:a,id:i}=e.props;return null==t?null:(0,m.jsx)(k.A,{as:"li",role:"presentation",children:(0,m.jsx)(T.A,{as:"button",type:"button",eventKey:n,disabled:s,id:i,className:r,...a,children:t})})}const D=e=>{const{id:t,onSelect:n,transition:s,mountOnEnter:r=!1,unmountOnExit:a=!1,variant:i="tabs",children:o,activeKey:l=M(o),...d}=(0,v.Zw)(e,{activeKey:"onSelect"});return(0,m.jsxs)(P,{id:t,activeKey:l,onSelect:n,transition:S(s),mountOnEnter:r,unmountOnExit:a,children:[(0,m.jsx)($.A,{id:t,...d,role:"tablist",as:"ul",variant:i,children:(0,H.Tj)(o,L)}),(0,m.jsx)(K,{children:(0,H.Tj)(o,e=>{const t={...e.props};return delete t.title,delete t.disabled,delete t.tabClassName,delete t.tabAttrs,(0,m.jsx)(B,{...t})})})]})};D.displayName="Tabs";const G=D;var _=n(5173),z=n.n(_);const J=e=>{let{transition:t,...n}=e;return(0,m.jsx)(P,{...n,transition:S(t)})};J.displayName="TabContainer";const V=J,F={eventKey:z().oneOfType([z().string,z().number]),title:z().node.isRequired,disabled:z().bool,tabClassName:z().string,tabAttrs:z().object},Z=()=>{throw new Error("ReactBootstrap: The `Tab` component is not meant to be rendered! It's an abstract component that is only valid as a direct Child of the `Tabs` Component. For custom tabs components use TabPane and TabsContainer directly")};Z.propTypes=F;const W=Object.assign(Z,{Container:V,Content:K,Pane:B});var q=n(1072),Q=n(8602),X=n(8628),Y=n(4282),ee=(n(6440),n(927)),te=n(6618),ne=n(2644);const se=s.forwardRef((e,t)=>{let{bsPrefix:n,active:s,disabled:r,eventKey:a,className:i,variant:o,action:l,as:u,...x}=e;n=(0,c.oU)(n,"list-group-item");const[f,v]=(0,ne.M)({key:(0,y.u)(a,x.href),active:s,...x}),b=(0,te.A)(e=>{if(r)return e.preventDefault(),void e.stopPropagation();f.onClick(e)});r&&void 0===x.tabIndex&&(x.tabIndex=-1,x["aria-disabled"]=!0);const h=u||(l?x.href?"a":"button":"div");return(0,m.jsx)(h,{ref:t,...x,...f,onClick:b,className:d()(i,n,v.isActive&&"active",r&&"disabled",o&&`${n}-${o}`,l&&`${n}-action`)})});se.displayName="ListGroupItem";const re=se,ae=s.forwardRef((e,t)=>{const{className:n,bsPrefix:s,variant:r,horizontal:a,numbered:i,as:o="div",...l}=(0,v.Zw)(e,{activeKey:"onSelect"}),u=(0,c.oU)(s,"list-group");let x;return a&&(x=!0===a?"horizontal":`horizontal-${a}`),(0,m.jsx)(ee.A,{ref:t,...l,as:o,className:d()(n,u,r&&`${u}-${r}`,x&&`${u}-${x}`,i&&`${u}-numbered`)})});ae.displayName="ListGroup";const ie=Object.assign(ae,{Item:re});var oe=n(6481),le=n(184);n(8736);const de=()=>{const[e]=(0,i.hD)(r.j),[t,n]=(0,s.useState)(0),[l,d]=(0,s.useState)({}),[c,u]=(0,s.useState)([]),[v,b]=(0,s.useState)(!0),[h,j]=(0,s.useState)(""),[y,N]=(0,s.useState)(null),[p,E]=(0,s.useState)("store"),A=(0,s.useMemo)(()=>oe.vd.filter(e=>e.redeemable).sort((e,t)=>{var n,s;return((null===(n=oe.Bc[e.tier])||void 0===n?void 0:n.order)||99)-((null===(s=oe.Bc[t.tier])||void 0===s?void 0:s.order)||99)}),[]),g=(0,s.useMemo)(()=>A.find(e=>e.isMaster),[A]),C=(0,s.useMemo)(()=>A.filter(e=>!e.isMaster),[A]),w=(0,s.useMemo)(()=>!(!e||e.isAnonymous)&&C.every(e=>l[e.id]),[e,l,C]);(0,s.useEffect)(()=>{(async()=>{if(e&&!e.isAnonymous)try{b(!0),j("");const t=(0,a.H9)(r.db,"userAchievements",e.uid),s=await(0,a.x7)(t);if(s.exists()){const e=s.data();n(e.points||0),d(e)}const i=(0,a.P)((0,a.rJ)(r.db,"redemptionHistory"),(0,a._M)("userId","==",e.uid)),o=(await(0,a.GG)(i)).docs.map(e=>e.data()).sort((e,t)=>{var n,s;return((null===(n=t.redeemedAt)||void 0===n?void 0:n.toDate())||0)-((null===(s=e.redeemedAt)||void 0===s?void 0:s.toDate())||0)});u(o)}catch(t){console.error("Error fetching user data or history: ",t),j("\u7121\u6cd5\u8f09\u5165\u5546\u5e97\u8cc7\u6599\uff0c\u8acb\u7a0d\u5f8c\u518d\u8a66\u3002")}finally{b(!1)}else b(!1)})()},[e]);const O=async s=>{if(!(!e||t<s.cost||l[s.id])){N(s.id),j("");try{const i=(0,a.wP)(r.db),o=(0,a.H9)(r.db,"userAchievements",e.uid);i.update(o,{points:t-s.cost,[s.id]:!0,[`${s.id}Date`]:(0,a.O5)()});const l=(0,a.H9)((0,a.rJ)(r.db,"redemptionHistory"));i.set(l,{userId:e.uid,userName:e.displayName,itemId:s.id,itemName:s.name,pointsSpent:s.cost,redeemedAt:(0,a.O5)()}),await i.commit(),n(e=>e-s.cost),d(e=>({...e,[s.id]:!0}));const c=(0,a.P)((0,a.rJ)(r.db,"redemptionHistory"),(0,a._M)("userId","==",e.uid)),m=(await(0,a.GG)(c)).docs.map(e=>e.data()).sort((e,t)=>{var n,s;return((null===(n=t.redeemedAt)||void 0===n?void 0:n.toDate())||0)-((null===(s=e.redeemedAt)||void 0===s?void 0:s.toDate())||0)});u(m)}catch(i){console.error("Error redeeming item: ",i),j("\u514c\u63db\u5931\u6557\uff0c\u8acb\u7a0d\u5f8c\u518d\u8a66\u3002")}finally{N(null)}}};return v?(0,m.jsx)(o.A,{className:"mt-5 text-center",children:(0,m.jsx)(x,{animation:"border"})}):!e||e.isAnonymous?(0,m.jsx)(o.A,{className:"mt-5",children:(0,m.jsx)(f.A,{variant:"warning",children:"\u8acb\u767b\u5165\u4ee5\u4f7f\u7528\u9ede\u6578\u5546\u5e97\u3002"})}):(0,m.jsxs)(o.A,{className:"mt-5",children:[(0,m.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,m.jsx)("h2",{children:"\u9ede\u6578\u5546\u5e97"}),(0,m.jsxs)(f.A,{variant:"success",className:"mb-0",children:[(0,m.jsx)(le.cEG,{className:"me-2"})," \u60a8\u76ee\u524d\u64c1\u6709\uff1a",(0,m.jsx)("strong",{children:t})," \u9ede"]})]}),h&&(0,m.jsx)(f.A,{variant:"danger",dismissible:!0,onClose:()=>j(""),children:h}),(0,m.jsxs)(G,{id:"redemption-store-tabs",activeKey:p,onSelect:e=>E(e),className:"mb-3 redemption-tabs",children:[(0,m.jsx)(W,{eventKey:"store",title:"\u514c\u63db\u5546\u5e97",children:(0,m.jsxs)(q.A,{xs:2,md:3,lg:5,className:"g-4",children:[C.map(e=>{const n=l[e.id],s=t>=e.cost,r=oe.Bc[e.tier];return(0,m.jsx)(Q.A,{children:(0,m.jsx)(X.A,{className:`achievement-card redeem-card-override h-100 ${n?"unlocked":"locked"} tier-${e.tier.toLowerCase()}`,children:(0,m.jsxs)(X.A.Body,{className:"d-flex flex-column",children:[(0,m.jsx)(X.A.Title,{children:e.name}),(0,m.jsx)(X.A.Text,{children:e.description}),(0,m.jsxs)("div",{className:"mt-auto",children:[(0,m.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[(0,m.jsxs)("span",{children:["\u7b49\u7d1a: ",r.name]}),(0,m.jsxs)("span",{style:{color:r.color,fontWeight:"bold"},children:[(0,m.jsx)(le.cEG,{className:"me-1"})," ",e.cost]})]}),(0,m.jsx)(Y.A,{variant:"primary",className:"w-100 btn-theme-gradient",disabled:n||!s||y===e.id,onClick:()=>O(e),children:y===e.id?(0,m.jsx)(x,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}):n?"\u5df2\u64c1\u6709":s?"\u514c\u63db":"\u9ede\u6578\u4e0d\u8db3"})]})]})})},e.id)}),g&&(0,m.jsx)(Q.A,{children:w?(0,m.jsx)(X.A,{className:`achievement-card redeem-card-override h-100 ${l[g.id]?"unlocked":"locked"} tier-${g.tier.toLowerCase()}`,children:(0,m.jsxs)(X.A.Body,{className:"d-flex flex-column",children:[(0,m.jsx)(X.A.Title,{children:g.name}),(0,m.jsx)(X.A.Text,{children:g.description}),(0,m.jsxs)("div",{className:"mt-auto",children:[(0,m.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[(0,m.jsxs)("span",{children:["\u7b49\u7d1a: ",oe.Bc[g.tier].name]}),(0,m.jsxs)("span",{style:{color:oe.Bc[g.tier].color,fontWeight:"bold"},children:[(0,m.jsx)(le.cEG,{className:"me-1"})," ",g.cost]})]}),(0,m.jsx)(Y.A,{variant:"primary",className:"w-100 btn-theme-gradient",disabled:l[g.id]||t<g.cost||y===g.id,onClick:()=>O(g),children:y===g.id?(0,m.jsx)(x,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}):l[g.id]?"\u5df2\u64c1\u6709":t<g.cost?"\u9ede\u6578\u4e0d\u8db3":"\u514c\u63db"})]})]})}):(0,m.jsx)(X.A,{className:"achievement-card redeem-card-override h-100 locked tier-master-mystery",children:(0,m.jsxs)(X.A.Body,{className:"d-flex flex-column justify-content-center align-items-center",children:[(0,m.jsx)(X.A.Title,{className:"mystery-title",children:"???"}),(0,m.jsx)(X.A.Text,{className:"mystery-text",children:"\u89e3\u9396\u6240\u6709\u5176\u4ed6\u5546\u5e97\u7269\u54c1\u4ee5\u63ed\u66c9"})]})})})]})}),(0,m.jsx)(W,{eventKey:"history",title:"\u514c\u63db\u7d00\u9304",children:c.length>0?(0,m.jsx)(ie,{children:c.map((e,t)=>{var n;return(0,m.jsxs)(ie.Item,{className:"d-flex justify-content-between align-items-center",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("strong",{children:e.itemName}),(0,m.jsx)("small",{className:"d-block text-muted",children:null===(n=e.redeemedAt)||void 0===n?void 0:n.toDate().toLocaleString()})]}),(0,m.jsxs)("span",{className:"text-danger",children:["-",e.pointsSpent," \u9ede"]})]},t)})}):(0,m.jsx)(f.A,{variant:"info",children:"\u60a8\u76ee\u524d\u6c92\u6709\u4efb\u4f55\u514c\u63db\u7d00\u9304\u3002"})})]})]})}},1719:(e,t,n)=>{n.d(t,{A:()=>N});var s=n(8139),r=n.n(s),a=n(5043),i=n(1969),o=n(6618),l=n(7852),d=n(4488),c=n(579);const m=(0,d.A)("h4");m.displayName="DivStyledAsH4";const u=a.forwardRef((e,t)=>{let{className:n,bsPrefix:s,as:a=m,...i}=e;return s=(0,l.oU)(s,"alert-heading"),(0,c.jsx)(a,{ref:t,className:r()(n,s),...i})});u.displayName="AlertHeading";const x=u;var f=n(7071);const v=a.forwardRef((e,t)=>{let{className:n,bsPrefix:s,as:a=f.A,...i}=e;return s=(0,l.oU)(s,"alert-link"),(0,c.jsx)(a,{ref:t,className:r()(n,s),...i})});v.displayName="AlertLink";const b=v;var h=n(8072),j=n(5632);const y=a.forwardRef((e,t)=>{const{bsPrefix:n,show:s=!0,closeLabel:a="Close alert",closeVariant:d,className:m,children:u,variant:x="primary",onClose:f,dismissible:v,transition:b=h.A,...y}=(0,i.Zw)(e,{show:"onClose"}),N=(0,l.oU)(n,"alert"),p=(0,o.A)(e=>{f&&f(!1,e)}),E=!0===b?h.A:b,A=(0,c.jsxs)("div",{role:"alert",...E?void 0:y,ref:t,className:r()(m,N,x&&`${N}-${x}`,v&&`${N}-dismissible`),children:[v&&(0,c.jsx)(j.A,{onClick:p,"aria-label":a,variant:d}),u]});return E?(0,c.jsx)(E,{unmountOnExit:!0,...y,ref:void 0,in:s,children:A}):s?A:null});y.displayName="Alert";const N=Object.assign(y,{Link:b,Heading:x})},2663:(e,t,n)=>{n.d(t,{Tj:()=>r,jJ:()=>a,mf:()=>i});var s=n(5043);function r(e,t){let n=0;return s.Children.map(e,e=>s.isValidElement(e)?t(e,n++):e)}function a(e,t){let n=0;s.Children.forEach(e,e=>{s.isValidElement(e)&&t(e,n++)})}function i(e,t){return s.Children.toArray(e).some(e=>s.isValidElement(e)&&e.type===t)}},8628:(e,t,n)=>{n.d(t,{A:()=>k});var s=n(8139),r=n.n(s),a=n(5043),i=n(7852),o=n(579);const l=a.forwardRef((e,t)=>{let{className:n,bsPrefix:s,as:a="div",...l}=e;return s=(0,i.oU)(s,"card-body"),(0,o.jsx)(a,{ref:t,className:r()(n,s),...l})});l.displayName="CardBody";const d=l,c=a.forwardRef((e,t)=>{let{className:n,bsPrefix:s,as:a="div",...l}=e;return s=(0,i.oU)(s,"card-footer"),(0,o.jsx)(a,{ref:t,className:r()(n,s),...l})});c.displayName="CardFooter";const m=c;var u=n(1778);const x=a.forwardRef((e,t)=>{let{bsPrefix:n,className:s,as:l="div",...d}=e;const c=(0,i.oU)(n,"card-header"),m=(0,a.useMemo)(()=>({cardHeaderBsPrefix:c}),[c]);return(0,o.jsx)(u.A.Provider,{value:m,children:(0,o.jsx)(l,{ref:t,...d,className:r()(s,c)})})});x.displayName="CardHeader";const f=x,v=a.forwardRef((e,t)=>{let{bsPrefix:n,className:s,variant:a,as:l="img",...d}=e;const c=(0,i.oU)(n,"card-img");return(0,o.jsx)(l,{ref:t,className:r()(a?`${c}-${a}`:c,s),...d})});v.displayName="CardImg";const b=v,h=a.forwardRef((e,t)=>{let{className:n,bsPrefix:s,as:a="div",...l}=e;return s=(0,i.oU)(s,"card-img-overlay"),(0,o.jsx)(a,{ref:t,className:r()(n,s),...l})});h.displayName="CardImgOverlay";const j=h,y=a.forwardRef((e,t)=>{let{className:n,bsPrefix:s,as:a="a",...l}=e;return s=(0,i.oU)(s,"card-link"),(0,o.jsx)(a,{ref:t,className:r()(n,s),...l})});y.displayName="CardLink";const N=y;var p=n(4488);const E=(0,p.A)("h6"),A=a.forwardRef((e,t)=>{let{className:n,bsPrefix:s,as:a=E,...l}=e;return s=(0,i.oU)(s,"card-subtitle"),(0,o.jsx)(a,{ref:t,className:r()(n,s),...l})});A.displayName="CardSubtitle";const g=A,C=a.forwardRef((e,t)=>{let{className:n,bsPrefix:s,as:a="p",...l}=e;return s=(0,i.oU)(s,"card-text"),(0,o.jsx)(a,{ref:t,className:r()(n,s),...l})});C.displayName="CardText";const w=C,O=(0,p.A)("h5"),P=a.forwardRef((e,t)=>{let{className:n,bsPrefix:s,as:a=O,...l}=e;return s=(0,i.oU)(s,"card-title"),(0,o.jsx)(a,{ref:t,className:r()(n,s),...l})});P.displayName="CardTitle";const $=P,T=a.forwardRef((e,t)=>{let{bsPrefix:n,className:s,bg:a,text:l,border:c,body:m=!1,children:u,as:x="div",...f}=e;const v=(0,i.oU)(n,"card");return(0,o.jsx)(x,{ref:t,...f,className:r()(s,v,a&&`bg-${a}`,l&&`text-${l}`,c&&`border-${c}`),children:m?(0,o.jsx)(d,{children:u}):u})});T.displayName="Card";const k=Object.assign(T,{Img:b,Title:$,Subtitle:g,Body:d,Link:N,Text:w,Header:f,Footer:m,ImgOverlay:j})},8736:()=>{}}]);
//# sourceMappingURL=652.a602318b.chunk.js.map